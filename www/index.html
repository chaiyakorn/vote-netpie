<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>NETPIE Vote</title>

        <!-- <link href="lib/ionic/css/ionic.css" rel="stylesheet"> -->
        <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above-->
        <link href="css/ionic.app.min.css" rel="stylesheet">
        <link href="css/social-icons.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        
        <!-- ionic/angularjs js -->
        <script src="lib/ionic/js/ionic.bundle.min.js"></script>

        <!-- cordova script (this will be a 404 during development) -->
        <!--<script src="cordova.js"></script>-->

        <script>
            // Facebbok OAuth init
            window.fbAsyncInit = function () {
                FB.init({
                    appId: '563906117137682', // Replace the App ID with yours
                    status: true, // check login status
                    cookie: true, // enable cookies to allow the server to access the session
                    xfbml: true  // parse XFBML
                });
            };

            // Load the SDK asynchronously
            (function (d) {
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement('script');
                js.id = id;
                js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                ref.parentNode.insertBefore(js, ref);
            }(document));
            // Facebbok OAuth init - END
            

        </script>
        <script src="https://netpie.io/microgear.js"></script>
        
<script> 
    const APPID = "testvote"; 
    const KEY = "g1cCF9jyPjRTq7l"; 
    const SECRET = "tig49bxdsWYX3fbU5CjjxH7VM"; 

    const ALIAS = "arm"; 

    var status = 0; 
    var onstatus=0;
    var msgbox=0;
    

    var microgear = Microgear.create({ 
        key: KEY, 
        secret: SECRET, 
        alias : ALIAS 
    }); 

    microgear.on('message',function(topic,msg) { 
        console.log(" on message"); 
        document.getElementById("data").innerHTML = msg; 
        console.log(msg); 
    }); 

    microgear.on('connected', function() { 
        console.log(" on connected"); 
        onstatus++;
        console.log(onstatus);
        microgear.setAlias(ALIAS); 
        document.getElementById("data").innerHTML = "เชื่อมต่อ NETPIE แล้ว"; 
        
        // setInterval(function() { 
        //     microgear.chat("server","Hello from server at "+Date.now()); 

        // },5000); 
    }); 

    microgear.on('present', function(event) { 
        console.log(event); 
        console.log(" on present"); 
    }); 

    microgear.on('absent', function(event) { 
        console.log(event); 
        console.log(" on absent"); 
    }); 
    function connectMicrogear(){ 
        status = 1; 
         onstatus=2;
        microgear.resettoken(function(err) { 
            microgear.connect(APPID); 
            console.log(" on resettoken");         
        }); 
    } 
     
</script>
    </head>
    <body ng-app="oauthApp">

        <!--
      The views will be rendered in the <ion-nav-view> directive below
      Templates are in the /templates folder (but you could also
      have templates inline in this html file if you'd like).
        -->
    <ion-nav-view animation="slide-left-right"></ion-nav-view>
     
    <script src="lib/angular-sanitize/angular-sanitize.min.js"></script>
    <script src="lib/angular-cookies/angular-cookies.min.js"></script>

    <!-- your app's js -->
    <script src = "js/app.js" ></script>
    <script src="js/controllers/controllers.js"></script>
    
</body>
</html>
